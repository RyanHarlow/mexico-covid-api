{"version":3,"sources":["components/map-style.js","components/utils.js","components/Map.js","App.js","index.js"],"names":["dataLayer","id","type","paint","property","stops","updatePercentiles","featureCollection","accessor","features","scale","scaleQuantile","domain","map","range","f","value","properties","percentile","Map","state","data","viewport","latitude","longitude","zoom","bearing","pitch","_loadData","setState","totalCases","_onViewportChange","_onClick","event","srcEvent","offsetX","offsetY","clickedFeature","find","layer","x","y","axios","get","then","res","console","log","this","className","style","left","top","margin","fontSize","name","height","width","position","mapStyle","onViewportChange","mapboxApiAccessToken","onClick","_renderTooltip","Component","App","ReactDOM","render","document","getElementById"],"mappings":"4TAAaA,EAAY,CACvBC,GAAI,OACJC,KAAM,OACNC,MAAO,CACL,aAAc,CACZC,SAAU,aACVC,MAAO,CACL,CAAC,EAAG,wBACJ,CAAC,EAAG,wBACJ,CAAC,EAAG,wBACJ,CAAC,EAAG,wBACJ,CAAC,EAAG,wBACJ,CAAC,EAAG,wBACJ,CAAC,EAAG,wBACJ,CAAC,EAAG,wBACJ,CAAC,EAAG,4B,wBCZL,SAASC,EAAkBC,EAAmBC,GAAW,IACvDC,EAAYF,EAAZE,SACDC,EAAQC,cACXC,OAAOH,EAASI,IAAIL,IACpBM,MAAMA,YAAM,IACf,MAAO,CACLZ,KAAM,oBACNO,SAAUA,EAASI,KAAI,SAAAE,GACrB,IAAMC,EAAQR,EAASO,GACjBE,EAAU,eACXF,EAAEE,WADS,CAEdC,WAAYR,EAAMM,KAEpB,OAAO,eAAID,EAAX,CAAcE,mBCVpB,IAiFeE,E,4MA5EbC,MAAQ,CACNC,KAAM,KACNC,SAAU,CACRC,SAAU,mBACVC,WAAY,IACZC,KAAM,mBACNC,QAAS,EACTC,MAAO,I,EAaXC,UAAY,SAAAP,GACV,EAAKQ,SAAS,CACZR,KAAMf,EAAkBe,GAAM,SAAAN,GAAC,OAAIA,EAAEE,WAAWa,iB,EAIpDC,kBAAoB,SAAAT,GAAQ,OAAI,EAAKO,SAAS,CAACP,c,EAG/CU,SAAW,SAAAC,GAAU,IAEjBxB,EAEEwB,EAFFxB,SAFgB,EAIdwB,EADFC,SAAWC,EAHK,EAGLA,QAASC,EAHJ,EAGIA,QAEhBC,EAAiB5B,GAAYA,EAAS6B,MAAK,SAAAvB,GAAC,MAAmB,SAAfA,EAAEwB,MAAMtC,MAE9D,EAAK4B,SAAS,CAACQ,iBAAgBG,EAAGL,EAASM,EAAGL,K,kEAzB3B,IAAD,OAClBM,IAAMC,IAAI,gBACTC,MAAK,SAAAC,GACH,IAAIxB,EAAOwB,EAAIxB,KACfyB,QAAQC,IAAI1B,GACb,EAAKO,UAAUP,Q,uCAuBD,IAAD,EACgB2B,KAAK5B,MAA7BiB,EADQ,EACRA,eAAgBG,EADR,EACQA,EAAGC,EADX,EACWA,EAE1B,OACEJ,GACE,yBAAKY,UAAU,UAAUC,MAAO,CAACC,KAAMX,EAAGY,IAAKX,EAAGY,OAAO,MAAOC,SAAS,SACvE,uCAAajB,EAAepB,WAAWsC,MACvC,iDAAuBlB,EAAepB,WAAWa,e,+BAMhD,IAAD,EACmBkB,KAAK5B,MAAvBE,EADD,EACCA,SAAUD,EADX,EACWA,KAEjB,OACE,yBAAK6B,MAAO,CAACM,OAAQ,OAAQC,MAAO,OAAQC,SAAU,aACpD,kBAAC,IAAD,iBACMpC,EADN,CAEEmC,MAAM,QACND,OAAO,QACPG,SAAS,kCACTC,iBAAkBZ,KAAKjB,kBACvB8B,qBApEW,mGAqEXC,QAASd,KAAKhB,WAEd,kBAAC,IAAD,CAAQ9B,KAAK,UAAUmB,KAAMA,GAC3B,kBAAC,IAAUrB,IAEZgD,KAAKe,uB,GAvEEC,a,MCIHC,MARf,WACE,OACE,yBAAKhB,UAAU,OACb,kBAAC,EAAD,QCFNiB,IAASC,OACP,kBAAC,EAAD,MACAC,SAASC,eAAe,W","file":"static/js/main.46fe315d.chunk.js","sourcesContent":["export const dataLayer = {\n  id: 'data',\n  type: 'fill',\n  paint: {\n    'fill-color': {\n      property: 'percentile',\n      stops: [\n        [0, 'rgba(255, 0, 0, .07)'],\n        [1, 'rgba(255, 0, 0, .14)'],\n        [2, 'rgba(255, 0, 0, .21)'],\n        [3, 'rgba(255, 0, 0, .28)'],\n        [4, 'rgba(255, 0, 0, .35)'],\n        [5, 'rgba(255, 0, 0, .42)'],\n        [6, 'rgba(255, 0, 0, .49)'],\n        [7, 'rgba(255, 0, 0, .56)'],\n        [8, 'rgba(255, 0, 0, .63)']\n      ]\n    }\n  }\n};","import {range} from 'd3-array';\nimport {scaleQuantile} from 'd3-scale';\n\nexport function updatePercentiles(featureCollection, accessor) {\n  const {features} = featureCollection;\n  const scale = scaleQuantile()\n    .domain(features.map(accessor))\n    .range(range(9));\n  return {\n    type: 'FeatureCollection',\n    features: features.map(f => {\n      const value = accessor(f);\n      const properties = {\n        ...f.properties,\n        percentile: scale(value)\n      };\n      return {...f, properties};\n    })\n  };\n}","import React, {Component} from 'react';\nimport MapGL, {Source, Layer} from 'react-map-gl';\nimport axios from 'axios';\nimport {dataLayer} from './map-style.js';\nimport {updatePercentiles} from './utils'\n\nconst MAPBOX_TOKEN = 'pk.eyJ1Ijoicnlhbmhhcmxvdzk1IiwiYSI6ImNrNTJ1c2NtbDAxdzczZ250eGZ5ZXYyY2gifQ.2EN37mO-Fn8QNmu-FoOFDA'; // Set your mapbox token here\n\n\nclass Map extends Component{\n\n  state = {\n    data: null,\n    viewport: {\n      latitude: 21.595592196250625,\n      longitude: -100,\n      zoom: 3.2241780332970342,\n      bearing: 0,\n      pitch: 0\n    }\n  };\n\n  componentDidMount() {\n    axios.get('/api/geojson')\n    .then(res => {\n       let data = res.data;\n       console.log(data)\n      this._loadData(data);\n    })\n  }\n\n  _loadData = data => {\n    this.setState({\n      data: updatePercentiles(data, f => f.properties.totalCases)\n    });\n  };\n\n  _onViewportChange = viewport => this.setState({viewport});\n\n\n  _onClick = event => {\n    const {\n      features,\n      srcEvent: {offsetX, offsetY}\n    } = event;\n    const clickedFeature = features && features.find(f => f.layer.id === 'data');\n\n    this.setState({clickedFeature, x: offsetX, y: offsetY});\n  };\n\n  _renderTooltip() {\n    const {clickedFeature, x, y} = this.state;\n\n    return (\n      clickedFeature && (\n        <div className=\"tooltip\" style={{left: x, top: y, margin:'1em', fontSize:'20px'}}>\n          <div>State: {clickedFeature.properties.name}</div>\n          <div>Number Of Cases: {clickedFeature.properties.totalCases}</div>\n        </div>\n      )\n    );\n  }\n\n  render(){\n    const {viewport, data} = this.state;\n\n    return(\n      <div style={{height: '100%', width: '100%', position: 'relative'}}>\n        <MapGL\n          {...viewport}\n          width=\"100vw\"\n          height=\"100vh\"\n          mapStyle=\"mapbox://styles/mapbox/light-v9\"\n          onViewportChange={this._onViewportChange}\n          mapboxApiAccessToken={MAPBOX_TOKEN}\n          onClick={this._onClick}\n        >\n          <Source type=\"geojson\" data={data}>\n            <Layer {...dataLayer} />\n          </Source>\n          {this._renderTooltip()}\n        </MapGL>\n      </div>\n    )\n  }\n}\n\nexport default Map;\n\n\n","import React from 'react';\nimport './App.css';\nimport Map from './components/Map';\nimport 'mapbox-gl/dist/mapbox-gl.css';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Map />\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\n\nReactDOM.render(\n  <App />,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}