{"version":3,"sources":["components/map-style.js","components/utils.js","components/Map.js","components/Header.js","components/Footer.js","App.js","index.js"],"names":["dataLayer","id","type","paint","property","stops","updatePercentiles","featureCollection","accessor","features","scale","scaleQuantile","domain","map","range","f","value","properties","percentile","Map","state","data","viewport","latitude","longitude","zoom","bearing","pitch","_loadData","setState","totalCases","_onViewportChange","_onClick","event","srcEvent","offsetX","offsetY","clickedFeature","find","layer","x","y","axios","get","then","res","console","log","this","className","style","position","top","left","margin","fontSize","backgroundColor","display","padding","border","borderRadius","zIndex","name","totalDeaths","JSON","stringify","height","width","mapStyle","onViewportChange","mapboxApiAccessToken","onClick","_renderTooltip","Component","Header","props","useState","setTotalDeaths","setTotalCases","useEffect","role","aria-label","flexDirection","href","color","class","Footer","App","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.8866df72.chunk.js","sourcesContent":["export const dataLayer = {\n  id: 'data',\n  type: 'fill',\n  paint: {\n    'fill-color': {\n      property: 'percentile',\n      stops: [\n        [0, 'rgba(255, 255, 0, 0)'],\n        [1, 'rgba(255, 223, 0, .5)'],\n        [2, 'rgba(255, 191, 0, .5)'],\n        [3, 'rgba(255, 159, 0, .5)'],\n        [4, 'rgba(255, 128, 0, .5)'],\n        [5, 'rgba(255, 96, 0, .5)'],\n        [6, 'rgba(255, 64, 0, .5)'],\n        [7, 'rgba(255, 32, 0, .5)'],\n        [8, 'rgba(255, 0, 0, .5)']\n      ]\n    }\n  }\n};","import {range} from 'd3-array';\nimport {scaleQuantile} from 'd3-scale';\n\nexport function updatePercentiles(featureCollection, accessor) {\n  const {features} = featureCollection;\n  const scale = scaleQuantile()\n    .domain(features.map(accessor))\n    .range(range(9));\n  return {\n    type: 'FeatureCollection',\n    features: features.map(f => {\n      const value = accessor(f);\n      const properties = {\n        ...f.properties,\n        percentile: scale(value)\n      };\n      return {...f, properties};\n    })\n  };\n}","import React, { Component } from 'react';\nimport MapGL, { Source, Layer } from 'react-map-gl';\nimport axios from 'axios';\nimport { dataLayer } from './map-style.js';\nimport { updatePercentiles } from './utils'\n\nconst MAPBOX_TOKEN = 'pk.eyJ1Ijoicnlhbmhhcmxvdzk1IiwiYSI6ImNrNTJ1c2NtbDAxdzczZ250eGZ5ZXYyY2gifQ.2EN37mO-Fn8QNmu-FoOFDA'; // Set your mapbox token here\n\n\nclass Map extends Component {\n\n  state = {\n    data: null,\n    viewport: {\n      latitude: 21.595592196250625,\n      longitude: -100,\n      zoom: 3.2241780332970342,\n      bearing: 0,\n      pitch: 0\n    }\n  };\n\n  componentDidMount() {\n    axios.get('/api/geojson')\n      .then(res => {\n        let data = res.data;\n        console.log(data)\n        this._loadData(data);\n      })\n  }\n\n  _loadData = data => {\n    this.setState({\n      data: updatePercentiles(data, f => f.properties.totalCases)\n    });\n  };\n\n  _onViewportChange = viewport => this.setState({ viewport });\n\n\n  _onClick = event => {\n    const {\n      features,\n      srcEvent: { offsetX, offsetY }\n    } = event;\n    const clickedFeature = features && features.find(f => f.layer.id === 'data');\n\n    this.setState({ clickedFeature, x: offsetX, y: offsetY });\n  };\n\n  _renderTooltip() {\n    const { clickedFeature, x, y } = this.state;\n\n    return (\n      clickedFeature && (\n        <div  className=\"tooltip\" style={{position:'absolute', top:'10px', left:'10px', margin: '.5em', fontSize: '20px', backgroundColor: 'white', display: 'inline-block', padding: '1rem', border: '1px solid black', borderRadius: '1em', zIndex: 1000 }}>\n          <div>State: {clickedFeature.properties.name}</div>\n          <div>Number Of Cases: {clickedFeature.properties.totalCases}</div>\n          <div>Number Of Deaths: {clickedFeature.properties.totalDeaths}</div>\n        </div>\n      )\n    );\n  }\n\n  render() {\n    const { viewport, data } = this.state;\n    console.log(JSON.stringify(this.state.clickedFeature))\n    return (\n      <div style={{ height: '100%', width: '100%', position: 'relative' }}>\n        <MapGL\n          {...viewport}\n          width=\"100vw\"\n          height=\"80vh\"\n          mapStyle=\"mapbox://styles/mapbox/dark-v9\"\n          onViewportChange={this._onViewportChange}\n          mapboxApiAccessToken={MAPBOX_TOKEN}\n          onClick={this._onClick}\n        >\n          <Source type=\"geojson\" data={data}>\n            <Layer {...dataLayer} />\n          </Source>\n          \n        </MapGL>\n        {this._renderTooltip()}\n      </div>\n    )\n  }\n}\n\nexport default Map;\n\n\n","import React, {useEffect, useState} from 'react';\nimport axios from 'axios';\n\n\nfunction Header(props) {\n\n  const [totalDeaths, setTotalDeaths] = useState(null);\n  const [totalCases, setTotalCases] = useState(null);\n  \n  useEffect(() => {\n    axios.get('/api/total')\n    .then(res => {\n      setTotalDeaths(res.data.totalDeaths);\n      setTotalCases(res.data.totalCases);\n    })\n  }, [])\n\n\n\n  return (\n    <nav className=\"navbar is-black\" role=\"navigation\" aria-label=\"main navigation\">\n      <div className='container' style={{ display: 'flex', flexDirection: 'column' }}>\n        <div className=\"navbar-brand\">\n          <a className=\"navbar-item\" href=\"https://bulma.io\" style={{ margin: 0, padding: 0 }}>\n            <h3 style={{ color: 'white', fontSize: '20px'}} class=\"title is-3\"><strong>Coronavirus Tracker Mexico</strong></h3>\n          </a>\n        </div>\n        <div style={{margin:0,padding:0}}>\n  <p>Total Deaths: {totalDeaths}</p>\n  <p>Total Cases: {totalCases}</p>\n        </div>\n      </div>\n    </nav>\n  );\n}\n\nexport default Header;","import React from 'react';\n\nfunction Footer(props){\n    return(\n        <footer style={{backgroundColor: 'black'}} class=\"footer is-black has-text-white\">\n  <div class=\"content has-text-centered\">\n    <p>\n      <strong style={{color:'white'}}>COV MX</strong> by Ryan Harlow. The website and source code is licensed <a href=\"http://opensource.org/licenses/mit-license.php\">MIT</a>. \n    </p>\n    <p>API documentation can be found <a href='https://github.com/RyanHarlow/mexico-covid-api'>Here</a></p>\n    <p>Data obtained from the <a href='https://www.gob.mx/salud'>Secretaria de Salud</a></p>\n  </div>\n</footer>\n    )\n}\n\nexport default Footer;","import React from 'react';\nimport './App.css';\nimport Map from './components/Map';\nimport 'mapbox-gl/dist/mapbox-gl.css';\nimport 'bulma/css/bulma.css'\nimport Header from './components/Header'\nimport Footer from './components/Footer';\n\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Header />\n      <Map />\n      <Footer />\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\n\nReactDOM.render(\n  <App />,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}